# Содействие проекту

## Как всё устроено

Каждая страница, отображаемая в главном меню, изначально представляет из себя файл .md в формате [Markdown](https://www.markdownguide.org/getting-started/).
Движком [mkdocs](https://www.mkdocs.org/) из маркдауна и картинок формируется статический веб-сайт.
Со структурой файлов и конфигурацией движка можно ознакомиться на [гитхабе](https://github.com/lord-vesel/dcs-doc/).

## Организация рабочего процесса

### Экспорт данных из пдф

Для этого, например, можно использовать утилиты `pdftotext` и `pdfimages` из пакета [poppler-utils](http://poppler.freedesktop.org).
Либо, обратиться к автору проекта за исходниками для работы.

Рекомендуемые опции pdftotext: `-nopgbrk -y 60 -W 1280 -H 500 -layout`

Получившийся текст нужно разделить на отдельные файлы, содержащие главы, и работать с каждой отдельно, формируя .md-файлы.

Каждый файл должен содержать только [один заголовок первого уровня](/help/#_12), из него формируется название в главном меню.

### Работа с иллюстрациями

Все картинки должны быть расположены в подкаталоге относительно файлов .md, ссылки на них должны быть относительные, например, `![](img/89-2.jpg)`.

Не все экспортированные картинки подходят для использования, например, те, что имеют оранжевые аннотации в пдф, экспортируются без них:

![](img/help/image-20200720232437233.png)

Такие приходится скриншотить каждую в отдельности.

#### Требования

Именование картинок: номер страницы, дефис, номер на странице (71-1.jpg).

Размер не более 1000рх по ширине, достаточно 200% масштаба пдф для оскриншочивания. Сжатие - 80%

Тень под картинкой, если имеется, в скриншот попадать не должна.

### Редакторы маркдауна

Под виндовз:

[Markdown Monster](https://markdownmonster.west-wind.com/): крайне хорош, способен вставлять картинки из буфера и сохранять их в подкаталоге.
Платный, хотя, как будто бы работает и незарегистрированным.

![](img/help/mm.jpg)

[Typora](https://typora.io/#windows): бесплатен, умеет работать с картинками из буфера (для этого нужно указать относительность путей в настройках).
Редактирование визуальное, что не всегда удобно. Рекомендуется с осторожностью.

![](img/help/typora.jpg)

### Ожидаемый результат

Переработанная документация к модулю должна быть представлена в виде каталога с файлами .md, один на каждую главу, а так же подкаталогом с иллюстрациями.

## Коротко о синтаксисе маркдауна

Маркдаун - лаконичный и минималистичный способ разметки документа. Это несёт в себе как лёгкость использования, так и ограничения, делающие невозможным сложное оформление, типа объединения ячеек в таблице.

### Базовый синтаксис

[Описание синтаксиса на сайте маркдауна](https://www.markdownguide.org/basic-syntax/)

#### Параграфы

Параграфы разделяются пустыми строками. Просто перенос строки в маркдауне не отобразится новой строкой в HTML.

Пример:

```
Уборка шасси производится 
на скоростях по прибору до 250 км/ч.
После отрыва слегка
нажмите тормоза, 
чтобы остановить 
вращение колес, 
после чего можете убрать шасси.
```

Результат:

> Уборка шасси производится
> на скоростях по прибору до 250 км/ч.
> После отрыва слегка
> нажмите тормоза,
> чтобы остановить
> вращение колес,
> после чего можете убрать шасси.

Пример параграфа:

```
Уборка шасси производится 
на скоростях по прибору до 250 км/ч.

После отрыва слегка
нажмите тормоза, 
чтобы остановить 
вращение колес, 
после чего можете убрать шасси.
```

Результат:

> Уборка шасси производится
> на скоростях по прибору до 250 км/ч.
>
> После отрыва слегка
> нажмите тормоза,
> чтобы остановить
> вращение колес,
> после чего можете убрать шасси.

Это очень облегчающая жизнь особенность, в контексте обработки ПДФ, так как не нужно заботиться о висящих строках.

Если всё же необходимо перенести строку, не создавая новый абзац, нужно использовать тег `<br>`, что часто востребовано при оформлении заголовков таблиц:

```
Ручка, <br>угол поворота | Наддув,<br>ata | Обороты,<br>об/мин
-------|--------|-----
22°    |  0.8   | 1500
26°    |  0.85  | 1600
```

Результат:

Ручка, <br>угол поворота | Наддув, <br>ata| Обороты, <br>об/мин
-------|--------|-----
22°    |  0.8   | 1500
26°    |  0.85  | 1600

#### Заголовки

Заголовками мы задаём иерархию документа, по которой создаётся содержание в правой части страницы.

Синтаксис:

	# Заголовок 1
	## Заголовок 2

!!! warning
    В одном документе может быть только один заголовок первого уровня.
    Им определяется наименование страницы в главном меню.

    Вся навигация по документу строится, начиная со второго уровня.

#### Списки

Маркированные списки формируются дефисом и пробелом перед каждым элементом.

Второй уровень вложенности задаётся четырьмя пробелами перед дефисом.

    - Проверить работу подкачивающих насосов топливных баков;
    включать на панели переключателей топливной системы по одному
    АЗС каждого насоса и контролировать давление топлива
    (0,3-0,4 atü) по прибору. Выключить насосы.
    - Включить бензонасосы:
        - E14   Бензонасос переднего бака
        - E13   Бензонасос заднего бака
        - E16   Бензонасос подвесного бака, если он используется
        - E96   Насос системы дополнительного бака, если необходимо

Результат:

> - Проверить работу подкачивающих насосов топливных баков;
> включать на панели переключателей топливной системы по одному
> АЗС каждого насоса и контролировать давление топлива
> (0,3-0,4 atü) по прибору. Выключить насосы.
> - Включить бензонасосы:
>     - E14   Бензонасос переднего бака
>     - E13   Бензонасос заднего бака
>     - E16   Бензонасос подвесного бака, если он используется
>     - E96   Насос системы дополнительного бака, если необходимо

Нумерованные списки формируются цифрой (не важно какой), точкой и пробелом перед каждым элементом:

    1. в условиях высокой влажности и при температурах ниже 0°с включите обогрев трубки пито и лобового стекла.
    1. включите оба бензонасоса и переключите топливомер на задний бак.
    1. в случае, если полёт проводится с подвесным топливным баком, включите бензонасосы только заднего и подвесного баков.
    2. установите щитки во взлетное положение на пульте на левой панели.

Результат:

> 1. в условиях высокой влажности и при температурах ниже 0°с включите обогрев трубки
>     пито и лобового стекла.
> 1. включите оба бензонасоса и переключите топливомер на задний бак.
> 1. в случае, если полёт проводится с подвесным топливным баком, включите бензонасосы
>     только заднего и подвесного баков.
> 2. установите щитки во взлетное положение на пульте на левой панели.

Если в элемент списка нужно добавить абзац, картинку, таблицу и т.п.,
не прерывая нумерацию,
то этот блок должен иметь отступ в четыре пробела от начала строки, а так же отделён пустыми строками до и после:

    1. Установить шаг винта на 12:00, отключить автоматическое управление шагом винта.
    2. Выполнять прогон без задержек. Контролируйте параметры работы по таблице:
    
        Шаг винта | Обороты, об/мин | Наддув, ata | Давление топлива, atü | Давление масла, atü | Температура масла, °С
        ----------|-----------------|-------------|-----------------------|---------------------|----------------------
        12:00 часов (Базовая настройка 12:35 при 25°) | 2430 ± 40 | 1,42 | От 1,25<br>До 1,75 | 15<br>8-9 | до 45<br>выше 45
    
        Проверка магнето и свечей зажигания на 2400 об/мин – последовательно переключать магнето в положения М1 и М2.<br>
        Обороты двигателя не должны упасть более, чем на 50 об/мин.
    
    3. Проверка автомата управления шагом винта. Контролировать соответствие параметров “Наддув – Обороты” по таблице:
    
        Наддув,<br>ata | Связанные обороты,<br>об/мин
        -----|-----
        0,85 | 1600
        0,9  | 1700
        1,0  | 1900
        1,05 | 2000
        1,10 | 2100
        1,14 | 2250
        1,28 | 2350
        1,32 | 2400
        1,42 | 2700
    
        При включении автомата шага винта показатели приборов не должны отличаться от табличных значений более,
        чем на ±80 оборотов. Причина расхождений: инертность центрального поста управления и неточность индикации тахометра.
    
    4. Избегайте длительной работы двигателя на малых/холостых
    оборотах по причине недостаточной смазки клапанов и, если
    требуется более длительное время ожидания, установите обороты 1200 об/мин.

Результат:

> 1. Установить шаг винта на 12:00, отключить автоматическое управление шагом винта.
> 2. Выполнять прогон без задержек. Контролируйте параметры работы по таблице:
>
>     Шаг винта | Обороты, об/мин | Наддув, ata | Давление топлива, atü | Давление масла, atü | Температура масла, °С
>     ----------|-----------------|-------------|-----------------------|---------------------|----------------------
>     12:00 часов (Базовая настройка 12:35 при 25°) | 2430 ± 40 | 1,42 | От 1,25<br>До 1,75 | 15<br>8-9 | до 45<br>выше 45
>
>     Проверка магнето и свечей зажигания на 2400 об/мин – последовательно переключать магнето в положения М1 и М2.<br>
>     Обороты двигателя не должны упасть более, чем на 50 об/мин.
>
> 3. Проверка автомата управления шагом винта. Контролировать соответствие параметров “Наддув – Обороты” по таблице:
>
>     Наддув, <br>ata | Связанные обороты, <br>об/мин
>     ------------|------------
>     0,85 | 1600
>     0,9 | 1700
>     1,0 | 1900
>     1,05 | 2000
>     1,10 | 2100
>     1,14 | 2250
>     1,28 | 2350
>     1,32 | 2400
>     1,42 | 2700
>
>     При включении автомата шага винта показатели приборов не должны отличаться от табличных значений более, чем на ±80 оборотов. Причина расхождений: инертность центрального поста управления и неточность индикации тахометра.
>
> 4. Избегайте длительной работы двигателя на малых/холостых оборотах по причине недостаточной смазки клапанов и, если требуется более длительное время ожидания, установите обороты 1200 об/мин.

#### Таблицы

Как видно из примеров выше, таблицы рисуются, разделяя ячейки вертикальными чертами.
Первая строка - заголовок, вторая, состоящая из дефисов - отделяющая загловок от содержательной части.

Число ячеек в каждой строке должно совпадать.

Объединить ячейки нельзя. Если встречается подобная конструкция:

![](img/help/image-20200717230634623.png)

то можно вынести дублирующие значения в скобки:

    Вес, кг | Длина разбега, м<br>Бетон (Трава) | Скороподъемность<br>после взлета, м/с<br>(щитки 10°) | Длина пробега, м<br>Бетон (Трава) | Время пробега, с <br>Бетон (Трава)
    -----|-------------|----|-----------|------------
    4000 |  640 (660)  | 11 | 380 (400) | 14,5 (15,5)
    4500 |  780 (820)  | 9  | 520 (560) |  18  (19,5)
    5000 |  960 (1110) | 7  | 680 (730) |  22  (24)
    5500 | 1200 (1280) | 5  | 880 (960) | 26,5 (29,5)

Результат:

Вес, кг | Длина разбега, м<br>Бетон (Трава) | Скороподъемность<br>после взлета, м/с<br>(щитки 10°) | Длина пробега, м<br>Бетон (Трава) | Время пробега, с <br>Бетон (Трава)
-----|-------------|----|-----------|------------
4000 |  640 (660)  | 11 | 380 (400) | 14,5 (15,5)
4500 |  780 (820)  | 9  | 520 (560) |  18  (19,5)
5000 |  960 (1110) | 7  | 680 (730) |  22  (24)
5500 | 1200 (1280) | 5  | 880 (960) | 26,5 (29,5)

#### Иллюстрации

Формируются следующим образом:

    ![Нажатая кнопка ”AUS”](img/-89-2.jpg)

Содержимое квадратных скобок становится подписью.

Результат:

![Нажатая кнопка ”AUS”](img/help/-89-2.jpg)

#### Ссылки

Синтаксис отличается от картинок только отсутствием восклицательного знака в начале.

    [Сайт mkdocs](https://www.mkdocs.org/)

Результат:

[Сайт mkdocs](https://www.mkdocs.org/)

### Дополнительные элементы

В проекте с помощью плагинов и расширений для python-markdown используется
дополнительный синтаксис. Эти элементы не будут корректно отображаться в markdown-редакторах.

#### Admonition

Блоки подсказок, предупреждений, информации и т.п.

Синтаксис:

    !!! warning
        Электрический стартер использовать с подключенным внешним электропитанием!
    
        Бортовой аккумулятор применять только в чрезвычайных ситуациях!
    
    !!! info
        В экстренном случае или при невозможности использования внешнего
        электропитания возможен запуск двигателя от бортового аккумулятора.

Результат:

!!! warning
    Электрический стартер использовать с подключенным внешним электропитанием!

    Бортовой аккумулятор применять только в чрезвычайных ситуациях!

!!! info
    В экстренном случае или при невозможности использования внешнего
    электропитания возможен запуск двигателя от бортового аккумулятора.

[Подробнее о возможных типах блоков.](https://squidfunk.github.io/mkdocs-material/extensions/admonition/#types)

#### Подстветка клавиатурных сочетаний

Синтаксис:

    Переключатель зажигания (магнето) перевести в положение M1+М2.
    Вперед [[End]], назад [[RShift]] + [[End]].

Результат:

> Переключатель зажигания (магнето) перевести в положение M1+М2.
> Вперед [[End]], назад [[RShift]] + [[End]].
